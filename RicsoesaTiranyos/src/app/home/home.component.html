<body>
    <!-- <div class="loader" *ngIf="!loaded">
        <div class="d-flex align-items-center load">
            <strong class="me-2">Töltés </strong>
            <div class="spinner-border ms-auto " role="status" aria-hidden="true"></div>
        </div>
    </div> -->

    <div class="col-12">
      <div class="new-model">
        <div class="row">
          <h3 class="col-3">Új esemény hozzáadása</h3>
          <button class="btn btn-primary col-1" (click)="resetPage()">Újratöltés</button>
        </div>
        <hr />
        <div class="row">
          <div class="col-12 col-lg-6">
            <mat-form-field appearance="fill">
              <mat-label>Stream kezdete</mat-label>
              <input matInput [matDatepicker]="db" required [(ngModel)]="newEventTMPdate">
              <mat-datepicker-toggle matSuffix [for]="db"></mat-datepicker-toggle>
              <mat-datepicker #db></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-12 col-lg-6">
            <mat-form-field appearance="fill">
              <mat-label>Stream vége</mat-label>
              <input matInput [matDatepicker]="db" required [(ngModel)]="newEventTMPdate">
              <mat-datepicker-toggle matSuffix [for]="db"></mat-datepicker-toggle>
              <mat-datepicker #db></mat-datepicker>
            </mat-form-field>
          </div>
          
        </div>

        <div class="row">
          <div class="col-2">
            <div class="input-group mb-3">
                <input type="time" class="form-control Time" step="00:15" [(ngModel)]="newEventTMPstart" (change)="onChangeTime($event)" required> 
            </div>
          </div>
          
          
          <div class="col-2">
            <div class="input-group mb-3">
              <input type="time" class="form-control Time" step="00:15" [(ngModel)]="newEventTMPend" required> 
            </div>
          </div>
        </div>
        <hr>

        <div class="col-12">
          <mat-form-field appearance="fill">
              <mat-label>Válassz egy játékot!</mat-label>
              <mat-select required [(ngModel)]="tmpGameId" #gameId>
                <mat-option *ngFor="let game of games" [value]="game._id" #optvalue>
                  {{game.name}} <button class="btn" [style]="{backgroundColor: game.color, border: '1px solid black'}" disabled> </button> <a class="ms-5 text-danger float-end" (click)="deleteGames(game._id)"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                      <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                    </svg></a>
                </mat-option>
                <mat-option value="99"> -- Új játék hozzáadása -- </mat-option>
              </mat-select>
            </mat-form-field>
        </div>

        <div class="input-group mb-3 newGame" *ngIf="tmpGameId == 99">
          <input type="text" class="form-control" placeholder="Játék neve" aria-label="Játék neve" [(ngModel)]="newGameName">
          <input type="file" (change)="onUploadChange($event)" class="form-control" placeholder="Kép">
          <input type="color" class="form-control form-control-color ColorPicker" id="exampleColorInput" value="#563d7c" title="Válassz színt!" [(ngModel)]="newGameColor">
          <button type="submit" class="btn btn-success" (click)="saveGames()">Mentés</button>
        </div>

        <div class="col-12" *ngIf="tmpGameId == 99">
          <div class="alert alert-info text-center"><a href="https://www.reduceimages.com/">Új játék hozzáadásához szükséges a kép méretének csökkentése! (600px * 400px)</a></div>
        </div>

        <div class="col-12">
          <div class="alert alert-success text-center" *ngIf="OKmessage">Sikeres művelet!</div>
          <div class="alert alert-danger text-center" *ngIf="errorMessage">Hiba van a rendszerben!</div>
        </div>
        
        <div class="col-12 d-flex justify-content-center">
          <button class="btn btn-success" *ngIf="!isModify" (click)="saveDates()">Hozzáadás</button>
          <button class="btn btn-primary" *ngIf="isModify" (click)="modifyDate()">Módosítás</button>
        </div>
      </div>

      <div class="new-model row" *ngIf="convertEvent">
        <div class="col-12">
          <h3>Konvertálás - {{convertEventName}} ({{convertEventDate}})</h3>
        </div>
        <hr />
        <div class="col-12 col-lg-4">
          <mat-form-field class="example-full-width" appearance="fill">
            <mat-label>Youtube link</mat-label>
            <input matInput placeholder="Link" [(ngModel)]="convertLink">
          </mat-form-field>
        </div>
        <div class="col-12 col-lg-6">
          <mat-form-field class="example-chip-list" appearance="fill">
            <mat-label>Típus</mat-label>
            <mat-chip-list #chipList >
              <mat-chip *ngFor="let convertType of convertTypes" (removed)="remove(convertType)">
                {{convertType}}
                <button matChipRemove>
                  X
                </button>
              </mat-chip>
              <input placeholder="Új típus..."
                     [matChipInputFor]="chipList"
                     [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                     [matChipInputAddOnBlur]="addOnBlur"
                     (matChipInputTokenEnd)="add($event)">
            </mat-chip-list>
          </mat-form-field>
        </div>
        <div class="col-12 col-lg-2">
          <button class="btn btn-success h-75 w-100" (click)="saveLink()">Konvertálás</button>
        </div>

      </div>
    </div>

    <div class="m-5">

      <table mat-table [dataSource]="dates"  class="mat-elevation-z8 w-100">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> Név </th>
          <td mat-cell *matCellDef="let element"><span class="th-name" [style]="{backgroundColor: element.game.color}" > {{element.game.name}} </span></td>
        </ng-container>

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef> Dátum </th>
          <td mat-cell *matCellDef="let element"> {{convertDate(element.start,". ")}} </td>
        </ng-container>

        <ng-container matColumnDef="functions">
          <th mat-header-cell *matHeaderCellDef> Funkciók </th>
          <td mat-cell *matCellDef="let element">
            <button class="btn btn-success me-3" title="Videóvá konvertálás" (click)="convertDates(element._id)" *ngIf="!convertableCheck(element.end)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-youtube" viewBox="0 0 16 16">
                <path d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01 0 0 1 1.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007 0 0 1-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309 0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007 0 0 1-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82l-.008-.104A31.4 31.4 0 0 1 0 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007 0 0 1 1.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788 0 0 1 7.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"/>
              </svg>
            </button> 
            <button class="btn btn-primary me-3" title="Esemény módosítása" (click)="dateById(element._id)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
              </svg>
            </button> 
            <button class="btn btn-danger" title="Esemény törlése" (click)="deleteDates(element._id)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </button> 
          </td>
        </ng-container>
      
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <div class="eventDetails" *ngIf="converting">
      <div class="container">
        
      </div>
    </div>
</body>